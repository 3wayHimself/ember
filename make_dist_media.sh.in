#! /bin/sh
current=${PWD}
media_dir=ember-media-@VERSION@

mkdir -p ${media_dir}/media/common
cd ${media_dir}
#try to get the textures needed
#don't include lines starting with "/"
grep -rIE --no-filename "^[^/].*texture 3d"  ../media/materials/scripts/*.material | replace "texture 3d_" "3d_" > common_textures.list
cd ${current}/media/common ; tar cf - `cat ${current}/${media_dir}/common_textures.list ` | ( cd ${current}/${media_dir}/media/common; tar xf -)

#copy all meshes
cd ${current}/media/common ; tar cf - `find . -name \*.mesh` | ( cd ${current}/${media_dir}/media/common; tar xf -)
cd ${current}/media/common ; tar cf - `find . -name \*.skeleton` | ( cd ${current}/${media_dir}/media/common; tar xf -)

cd ${current}/${media_dir}
cp -a ../media/README ../media/fonts ../media/materials ../media/models ../media/packs ../media/particle media
rm -f ${current}/${media_dir}/common_textures.list






